<template>
    <div class="scanner-container">
        <template if:true={errorMessage}>
            <div class="slds-notify slds-notify_alert slds-alert_error" role="alert">
                <span class="slds-assistive-text">error</span>
                <h2>{errorMessage}</h2>
            </div>
        </template>
        
        <template if:false={isScanning}>
            <div class="slds-text-align_center slds-p-around_large">
                <lightning-icon icon-name="utility:photo" size="large" alternative-text="Camera"></lightning-icon>
                <p class="slds-m-top_small">Click Start Scanning to begin</p>
                <lightning-button
                    label="Start Scanning"
                    variant="brand"
                    onclick={startScanning}
                    class="slds-m-top_medium"
                    data-testid="start-scan-btn">
                </lightning-button>
            </div>
        </template>
        
        <template if:true={isScanning}>
            <div class="video-container">
                <video lwc:ref="videoElement" autoplay playsinline></video>
                <canvas lwc:ref="canvasElement"></canvas>
            </div>
            
            <div class="slds-text-align_center slds-m-top_medium">
                <lightning-button
                    label="Stop Scanning"
                    variant="destructive"
                    onclick={stopScanning}
                    data-testid="stop-scan-btn">
                </lightning-button>
            </div>
            
            <div class="slds-text-align_center slds-m-top_small">
                <p class="slds-text-body_small">Position the QR code within the camera view</p>
            </div>
        </template>
        
        <template if:true={scannedCode}>
            <div class="slds-notify slds-notify_alert slds-alert_success slds-m-top_medium" role="alert">
                <span class="slds-assistive-text">success</span>
                <h2>âœ“ QR Code Scanned: {scannedCode}</h2>
            </div>
        </template>
    </div>
</template>
